# SIDAInfo-Updates
This is the node script created for updating the DHIS2 data from the SIDAinfo data dump for PSI Burundi.

## Installation of the script
- Install node (version 12 or above)
- Download the code of the script from github or another source
- Unzip the code
- Go to the ```SIDAInfo-Updates``` folder (```cd SIDAInfo-Updates```)
- Install the script dependencies (npm install)

## Preparation of the source files
1. Run SIDAInfo-DHIS2 script to generate the file OUcode_YYYY_MM_DD-patient_code_uid-FINAL.json
2. Save the file in the root directory & rename it to patient_code_uid-FINAL.json
3. Save generated teis folders in SIDAInfo-Updates/teis
4. Run ```node retrieveDHISdata.js```to download the data from the DHIS2 server (formatted files will be stored in DHIS2_data folder). This script generate files enfant.json, mere.json, tarv.json, teis.json and, finally, patient_code_uid.json in folder PREVIOUS_DHIS2_data/OUcode_YYYY_MM_DD. The file patient_code_uid.json is used in the diff script.


## Folders in the script
- ```log```: For the log files generated by the script
- ```PREVIOUS_DHIS2_data```: For the formated files generated by the script from the DHIS2 data 
- ```teis```: For the TEI files generated by SIDAInfo script from the new dump
- ```actions```: For the actions files generated by SIDAInfo-Updates script

## Run the script
- Run the script using the arguments: ```node .\index.js diff --org_unit=XXXXXXXXXXXXX --export_dump_date=YYYY_MM_DD```
- Arguments: ORGUNIT, EXPORT_DATE_CURRENT
- Need help? run ```node generate help```

## Output files
- ```actions.json```: objects structure to be read by ```uploadData.js```

## Comments
- OrganisationUnit is not reviewed (it's assumed that is the same since it comes from the same source file given as an argument)
